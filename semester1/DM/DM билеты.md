# Глава 3.1. Паросочетания, независимые множества и покрытия

## Билет 1. Независимые множества, паросочетания и покрытия в графе. Теорема Галлаи.
1) Множество вершин $U\subset V(G)$ называется **независимым**, если никакие две его вершины не смежны.
> *Обозначение*: $\alpha(G)$  - **количество вершин** в **максимальном** независимом множестве графа $G$.

2) Множество рёбер $M \subset E(G)$ называется **паросочетанием**, если никакие два его ребра не имеют общей вершины.
> *Обозначение*: $\alpha'(G)$ - **количество рёбер** в **максимальном** паросочетании графа $G$.

3) Будем говорить, что множество вершин $W \subset V(G)$ **покрывает** ребро $e \in E(G)$, если существует вершина $w \in W$ , инцидентная $e$. 

4) Будем говорить, что множество рёбер $F \subset E(G)$ **покрывает** вершину $v \in V(G)$, если существует ребро $f \in F$, инцидентное $v$ .

5) Паросочетание $M$ графа $G$ называется совершенным, если оно покрывает все вершины графа.

6) Множество вершин $W \subset V(G)$ называется вершинным покрытием, если оно покрывает все рёбра графа.
> *Обозначение*: $\beta(G)$ **количество вершин** в **минимальном** вершинном покрытии графа $G$ .

7) Множество рёбер $F \subset E (G)$ называется рёберным покрытием, если оно покрывает все вершины графа.
> *Обозначение*: $\beta'(G)$ **количество рёбер** в **минимальном** рёберном покрытии графа $G$ .

### Лемма 1
1) $U \subset V (G)$ — независимое множество, если и только если $V (G)\ \backslash\ U$ — вершинное покрытие.
2) $\alpha(G) + \beta(G) = v(G)$. (Верно для любого графа).
> *Повторение*: $\alpha(G)$  - **количество вершин** в **максимальном** независимом множестве графа $G$.
>  *Повторение*: $\beta(G)$ **количество вершин** в **минимальном** вершинном покрытии графа $G$
#### Доказательство
$U \subset V (G)$ — максимальное независимое множество, если и только если $V (G)\ \backslash\ U$ — минимальное вершинное покрытие

### Теорема Галлаи
**(T. Gallai, 1959)** Пусть $G$ — граф с $\delta(G) > 0$. Тогда $\alpha'(G) + \beta'(G) = v(G)$
> *Повторение*: $\delta(G)$ - минимальная степень вершины графа $G$.
> *Повторение*: $\alpha'(G)$ - **количество рёбер** в **максимальном** паросочетании графа $G$.
> *Повторение*: $\beta'(G)$ **количество рёбер** в **минимальном** рёберном покрытии графа $G$ .
#### Доказательство (сначала $\leq$ потом $\geq$)
$\leq$
- Пусть $M$ — **максимальное паросочетание**, $U$ — множество **не покрытых** $M$ вершин графа, тогда $|U| = v (G) − 2\alpha'(G )$.
- Так как $\delta (G) > 0$, можно выбрать множество $F$ из $|U|$ рёбер, покрывающее $U$.
- Тогда $M \cup F$ — покрытие, следовательно, 
$\beta'(G) \leq |M \cup F | = \alpha'(G) + v(G) − 2\alpha'(G)$, откуда
$\alpha'(G) + \beta'(G) \leq v(G)$.

$\geq$
- Пусть $L$ — минимальное рёберное покрытие $(|L| = \beta'(G))$, а $H = (V(G), L)$.
> *Обьяснение*: $H = (V(G), L)$ - граф $H$ образован из вершин графа $G$ и ребёр покрытия $L$.
- Так как в графе $H$ нет вершин степени 0, в каждой компоненте графа $H$ можно выбрать по ребру, в результате получится паросочетание $N$ в графе $H$ (а значит, и в $G$).
- Следовательно, $\alpha'(G) ≥ |N| = c(H)$ и 
$\beta'(G ) = |L| = e(H) \geq v(H) − c(H) = v (G ) − c(H) \geq v (G ) − \alpha'(G )$, откуда следует $\alpha'(G) + \beta'(G) \geq v(G)$.
- Получаем, что $\alpha'(G) + \beta'(G) = v(G)$.


## Билет 2. Максимальное паросочетание и дополняющие пути: теорема Бержа.
Пусть $M$ — паросочетание в графе $G$.
1) Назовём путь $M$-***чередующимся***, если в нём чередуются рёбра из $M$ и рёбра, не входящие в $M$.
2) Назовём $M$-чередующийся путь $M$-***дополняющим***, если его начало и конец не покрыты паросочетанием $M$.

• В $M$-***дополняющем*** пути нечётное число рёбер, причем рёбер из паросочетания $M$ на одно меньше, чем рёбер, не входящих в $M$

 ### Теорема Бержа
**(C. Berge, 1957)** Паросочетание $M$ в графе $G$ является *максимальным* тогда и только тогда, когда нет $M$-***дополняющих*** путей.

#### Доказательство
$\Rightarrow$ 
- Пусть в графе $G$ существует $M$-дополняющий путь $S = a_1a_2 \ldots a_{2k}$ .
- Тогда заменим входящие в $M$ рёбра $a_2a_3,\ldots , a_{2k−2}a_{2k−1}$ на не входящие в M рёбра $a_1a_2, a_3a_4,. . . , a_{2k−1}a_{2k}$, и тем самым получим большее паросочетание. Противоречие.

$\Leftarrow$
- Пусть $M$ — не максимальное паросочетание, тогда рассмотрим максимальное паросочетание $M'$, $|M'| > |M|$.
- Пусть $N = M \Delta M'$, $H = G (N)$. Для любой вершины $v \in V(H)$ мы имеем $d_H (v) \in \{1, 2\}$, следовательно, $H$ — объединение нескольких путей и циклов.
- В каждом из этих путей и циклов рёбра паросочетаний $M$ и $M'$ чередуются. Так как рёбер из $M'$ в $E(H)$ больше, хотя бы одна компонента $P$ графа $H$ — путь нечётной длины, в котором больше рёбер из $M'$. Легко понять, что $P$ — это **$M$-дополняющий** путь. Противоречие.
>*Объяснение*: $M \Delta M'$ - это симметрическая разность: $M\Delta M'=(M\ \backslash \  M')\cup (M'\ \backslash \  M)$

![photo](https://github.com/Dkanil/ITMO/blob/main/semester1/DM/Symmetric%20difference.png?raw=true)
## Билет 3. Теорема Холла.
- Пусть $G = (V_1, V_2, E)$ — двудольный граф с долями $V_1$ и $V_2$.

**(P. Hall, 1935.)** В двудольном графе G есть паросочетание, покрывающее все вершины доли $V_1$, **если и только если** для **любого** множества $U \subset V_1$ выполняется $|U| \leq |N_G (U)|$.
>*Повторение*: $|N_G (U)|$ окрестность множества вершин $U$ — множество всех вершин графа $G$ , смежных с вершинами из $U$.
>*Повторение*: Граф называется **двудольным**, если его вершины можно
разбить на два множества (т.е. две доли), внутри которых **нет** рёбер.

• Условие о размере окрестности из теоремы Холла мы
будем называть **условием Холла** для доли $V_1$.
#### Доказательство
$\Rightarrow$
Очевидно, так как концы рёбер паросочетания, покрывающих вершины из $U$ — разные вершины из $N_G(U)$.
$\Leftarrow$
Докажем по индукции по количеству вершин в графе: 
База для $|V_1| = 1$ очевидна. 
Индукционный переход: Предположим, что для меньшего чем $G$ графа утверждение уже доказано. 
Разберём два случая.
##### Cлучай 1: 
Существует такое непустое множество $A \subsetneq V_1$, что $|A| = |N_G(A)|$.
- Введём обозначения $B = N_G(A)$, $A' = V_1 \ \backslash \ A$, $B' = V_2 \ \backslash \ B$. Пусть $G_1 = G (A \cup B)$, $G_2 = G (A' \cup B')$.
- Очевидно, для двудольного графа $G_1$ и его доли $A$ выполняется условие Холла. По индукционному предположению в графе $G_1$ существует паросочетание $M_1$, покрывающее $A$.
- Проверим условие Холла для двудольного графа $G_2$ и его доли $A'$. Рассмотрим $U \subset A'$. Тогда 
$|U| + |A| = |U \cup A| \leq |N_G (U \cup A)| = |N_{G_2} (U) \cup B| = |N_{G_2}(U)| + |B| = |N_{G_2}(U)| + |A|$, откуда следует $|U| ≤ |N_{G_2}(U)|$.
- Значит, в графе $G_2$ существует паросочетание $M_2$, покрывающее все вершины из $A'$. Тогда $M_1 \cup M_2$ — паросочетание в $G$ , покрывающее $V_1$.
##### Cлучай 2:
 Для любого непустого множества $A \subsetneq V_1$ выполняется $|N_G (A)| > |A|$.
- Рассмотрим произвольную вершину $a \in V_1$ и смежную с ней вершину $b \in V_2$.
- Пусть $G' = G\ −\ a\ −\ b$. Проверим условие Холла для двудольного графа $G'$ и его доли $V_1 \ \backslash \ {a}$. Для любого множества $A \subset V_1 \ \backslash \ \{a\}$ выполняется 
$|A| \leq |N_G(A)| − 1 \leq |N_G (A) \ \backslash \ \{b\}| = |N_{G'} (A)|$.
- Поэтому в графе $G'$ существует паросочетание, покрывающее $V_1 \ \backslash \ \{a\}$. Вместе с ребром $ab$ получаем искомое паросочетание.

## Билет 4. Следствия из теоремы Холла: паросочетания в двудольном графе, где степени одной доли больше чем другой, а также в регулярном двудольном графе.
### Следствие 1
В двудольном графе $G = (V_1, V_2, E)$ все вершины из $V_1$ имеют степени не меньше $k$, а все вершины $V_2$ имеют степени не больше $k$. Тогда есть паросочетание, покрывающее $V_1$.
#### Доказательство
- Проверим условие Холла для доли $V_1$.
Пусть $A \subset V_1(G)$, тогда из вершин $A$ выходит не менее чем $k \cdot |A|$ рёбер к вершинам из $N_G(A)$, а в каждую вершину $b \in N_G(A)$ входит не более, чем $k$ рёбер из вершин множества $A$.
- Таким образом, 
$k|A| \leq e_G (A, N_G(A)) \leq k|N_G(A)|$,
откуда $|A| \leq |N_G(A)|$
>*Обозначение*: $e_G (A, N_G(A))$ - количество рёбер, соединяющих вершины множества $A$ с вершинами множества $N_G(A)$

### Следствие 2
**(D. König, 1916.)** Пусть $G = (V_1, V_2, E)$ — регулярный двудольный граф степени $k$. Тогда $G$ есть объединение $k$ своих совершенных паросочетаний.
#### Доказательство
- По Следствию 1 в $G$ существует паросочетание $M$, покрывающее $V_1$.
- Так как степени всех вершин равны по $k$, а каждое ребро соединяет $V_1$ и $V_2$, мы имеем $k|V_1| = e(G) = k|V_2|$.
- Следовательно, $|V_1| = |V_2|$. Поэтому, паросочетание $M$ покрывает и долю $V_2$, то есть, $M$ — совершенное.
- $G − M$ — регулярный двудольный граф степени $k − 1$. Продолжая выделять совершенные паросочетания, мы разобьём граф $G$ на $k$ паросочетаний.

## Билет 5. Теорема о гареме.
В одной далекой стране проживают юноши $\{A_1, \dots , A_n\}$. 
Для каждого $i \in \{1, . . . , n\}$, юноша $A_i$ хочет завести гарем из $k_i$ знакомых ему девушек (естественно, $k_i \in \mathbb{N}$).
Они могут это одновременно сделать тогда и только тогда, когда для любого множества юношей количество знакомых хотя бы одному из них девушек не меньше, чем сумма желаемых ими размеров гаремов.
#### Доказательство
- Построим двудольный граф $G = (V_1, V_2, E)$.
- Вершины доли $V_1$ соответствуют юношам — каждому $A_i$ соответствует $k_i$ вершин $a_{i, 1}, \dots , a_{i,k_i}$ (назовем их копиями $A_i$).
- Вершины доли $V_2$ соответствуют девушкам. Каждая вершина $a_{i,j} \in V_1$ соединена в точности с теми девушками из $V_2$, с которыми знаком юноша $A_i$.
- Проверим, что для доли $V_1$ выполнено условие Холла.
- Пусть $M \subset V_1$, а $A_{i_1} , \dots , A_{i_m}$ — все юноши, чьи копии есть в $M$.
- Тогда $|N_G (M)| \geq k_{i_1} + \cdots + k_{i_m}$ (в $N_G(M)$ входят все девушки, знакомые с $A_{i_1} , \dots , A_{i_m}$).
- В то же время, $|M| \leq k_{i_1} + \cdots + k_{i_m}$ (в $M$ не может входить больше копий $A_{i_1} , \dots , A_{i_m}$ , чем их существует).
- Таким образом, в $G$ есть паросочетание, покрывающее $V_1$.
- Для каждого $A_i$ девушки, входящие в пары с его копиями, образуют гарем желаемого размера.

## Билет 6. Теорема Кёнига и ее следствие. 
### Теорема Кёнига
**(D. König, 1931.)** Пусть $G$ — двудольный граф. Тогда $\alpha'(G) = \beta(G)$
> *Повторение*: $\alpha'(G)$ - **количество рёбер** в **максимальном** паросочетании графа $G$.
>  *Повторение*: $\beta(G)$ **количество вершин** в **минимальном** вершинном покрытии графа $G$
> *Повторение* [билет 1](#билет-1-независимые-множества-паросочетания-и-покрытия-в-графе-теорема-галлаи)

#### Доказательство (сначала $\leq$, потом $\geq$)
$\leq$
Так как рёбра паросочетания не имеют общих концов, то в любом вершинном покрытии не меньше вершин, чем в любом паросочетании рёбер. Следовательно, $\alpha'(G) \leq \beta(G)$.

$\geq$
- Пусть $M$ — максимальное паросочетание в графе $G$, 
$U_1$ — множество всех непокрытых этим паросочетанием вершин $V_1$,  
$U_2$ — множество непокрытых $M$ вершин $V_2$.
- Разобьём все покрытые паросочетанием $M$ вершины $V_1$ на два множества: $Y_1$ — те вершины, до которых можно дойти от $U_1$ по $M$-чередующимся путям, а $Z_1$ — вершины, до которых дойти таким образом нельзя.
- Разобьём все покрытые паросочетанием $M$ вершины $V_2(G)$ на два множества: $Y_2$ — те вершины, до которых можно дойти от $U_1$ по $M$-чередующимся путям, а $Z_2$ — вершины, до которых дойти таким образом нельзя
- Выясним, как должны проходить рёбра паросочетания $M$ и остальные рёбра графа $G$ между определенными выше множествами вершин. На рисунке сплошными линиями показаны рёбра паросочетания $M$, пунктирными линиями — невозможные рёбра. 
Далее мы объясним, почему граф устроен именно так.
- Любой $M$-чередующийся путь приходит в вершины множества $Y_1$ по ребрам из $M$, поэтому предыдущая вершина перед $Y_1$ на таком пути должна лежать в $Y_2$.
- Рёбра паросочетания $M$ не могут соединять $Y_2$ c $Z_1$ (иначе был бы $M$-чередующийся путь от $U_1$ до $Z_1$). 
Следовательно, паросочетание $M$ соединяет друг с другом $Y_1$ и $Y_2$ а также $Z_1$ и $Z_2$

**Докажем, что $B = Z_1 \cup Y_2$ — вершинное покрытие.**
- $E_G (U_1 \cup Y_1, Z_2) = \varnothing$. (Рёбра не из $M$ не могут соединять вершины из $U_1 \cup Y_1$ c вершинами из $Z_2$: иначе был бы $M$-чередующийся путь от $U_1$ до $Z_2$)
- $E_G (U_1 \cup Y_1, U_2) = \varnothing$. (Если бы такое ребро существовало, то существовал бы $M$-дополняющий путь, что по теореме Бержа для максимального паросочетания $M$ невозможно.)
Так как $B$ — вершинное покрытие и $|M| = |B|$, имеем $\alpha'(G) \geq \beta(G)$.
![photo](https://github.com/Dkanil/ITMO/blob/6c965ea91ef4991295864b2663ff2a2465ac9e2d/semester1/DM/Konig.png?raw=true)
### Следствие из теорем Кенига и Галлаи
Пусть $G$ — двудольный граф с $\delta(G) > 0$. Тогда $\alpha(G) = \beta'(G)$.

#### Доказательство
- По [Теореме Кёнига](#теорема-кёнига) для двудольного графа выполняется соотношение $\alpha'(G) = \beta(G)$.
- По [Лемме 1](#лемма-1) для любого графа
$\alpha(G) + \beta(G) = v(G)$ 
- По [Теореме Галлаи](#теорема-галлаи) , так как $\delta(G)>0$, то
$\alpha'(G) + \beta'(G) = v(G)$
Решив систему, следует, что $\alpha(G) = \beta'(G)$.

## Билет 7. Паросочетания с предпочтениями. Теорема Гэйла-Шепли.
> Иногда вершинам не всё равно, с какими вершинами “вступать в паросочетание”. 
> Предположим, что каждая вершина имеет список предпочтений, то есть, упорядочивает инцидентные ей рёбра. 
> Построим такое паросочетание $M$ (не обязательно максимальное), что в нём не будет ребра $e = ab$, которое обе вершины $a$ и $b$ хотели бы поменять на свободные рёбра. Дадим строгие определения

1) Пусть для каждой вершины $v \in V (G)$ задано линейное отношение (нестрогого) порядка $\leq_v$ на множестве всех инцидентных $v$ рёбер из $E(G)$. Тогда $≤ \ = \{≤_v \}_{v ∈V (G )}$ — **множество предпочтений**.
>Например, если у вершины $v$ есть рёбра $e_1$, $e_2$,$e_3$​, то она может сказать, что $e_1 \leq_v e_2 \leq_v e_3$​, где $e_1$​ наименее предпочтительное ребро, а $e_3$​ — наиболее

2) Паросочетание $M$ называется стабильным для множества предпочтений $\leq$, если для любого ребра $f \not\in M$ существует такое ребро $e \in M$, что $e$ и $f$ имеют общий конец $v$ и $f \leq_v e$.

> *Объяснение* $f \leq_v e$:  вершина $v$ предпочитает ребро $e$, уже включённое в паросочетание, ребру $f$, которого нет в паросочетании.
> 
> Ни одно ребро $f \not\in M$ не может "разрушить" стабильность, потому что для вершины $v$, которая соединена с $f$, уже существует ребро $e \in M$, которое для этой вершины лучше (или равно по предпочтению), чем $f$, а значит ребро $f$ не может быть включёно в стабильное паросочетание.

### Stable marriage theorem (теорема о деревенских свадьбах)
**(D. Gale, L. Shapley, 1962.)** Пусть $G$ — двудольный граф. Тогда для любого множества предпочтений $\leq$ в графе $G$ существует стабильное паросочетание.

#### Доказательство
- Будем считать вершины **одной доли мужчинами**, а вершины **другой доли — женщинами**, а наше паросочетание будет состоять из семейных пар. **Изначально наше паросочетание пусто**, оно будет изменяться пошагово. 

*Опишем шаг алгоритма изменения паросочетания*.
- Сначала действуют **мужчины**:
каждый **неженатый** (то есть, не покрытый паросочетанием) **мужчина выбирает женщину**, которая ему больше всех нравится (то есть, наивысшую в своем предпочтении) из тех, **которым он еще не делал предложения** (если такие есть), после чего делает ей предложение.
- Затем действуют **женщины**:
каждая из них **рассматривает всех мужчин**, кто сделал ей предложение и нравится ей строго больше, чем ее муж (если он есть). Если это множество непусто, она **выбирает из них того, кто нравится ей больше всего** (если таких несколько, то любого из них) и выходит за него замуж (вместо ее прежнего мужа, если он был) ~~ш-общительная~~.
- Конечность алгоритма очевидна: никакой мужчина **не делает предложение одной женщине дважды**. Пусть в результате получилось паросочетнание M.

*Докажем, что* $M$ *стабильно*. 
- Рассмотрим любое ребро $uw \in E(G) \backslash M$ (где $u$ — мужчина).
- Если $u$ делал предложение $w$ , то 
	- либо $w$ ему отказала, 
	- либо сначала приняла предложение, но потом бросила, 
- Значит $w$ нашла мужа $u'$, который ей нравится не меньше, чем $u$ (то есть, существует ребро $u'w \in M$, для которого $uw \leq_w u'w$).
- Если же $u$ не делал предложения $w$ , то в процессе алгоритма нашел жену $w'$, которая нравится ему не меньше, чем $w$ (то есть, существует ребро $uw' \in M$, для которого $uw \leq_u uw'$).
- Таким образом, построеннное паросочетание стабильно по определению. 

## Билет 8. Теорема Татта о совершенном паросочетании.
> *Обозначение*: $o(G)$ - количество нечётных компонент связности произвольного  графа $G$ (то есть, компонент связности, содержащих нечётное число вершин).
### Теорема Татта
**(W. T. Tutte, 1947.)** В графе $G$ существует совершенное паросочетание тогда и только тогда, когда для любого $S \subset V (G)$ выполняется условие $o(G − S) \leq |S|$
> *Повторение* Совершенное паросочетание $M$ графа $G$ - покрывающее все вершины графа.
> *Повторение* [билет 1](#билет-1-независимые-множества-паросочетания-и-покрытия-в-графе-теорема-галлаи)

#### Доказательство
$\Rightarrow$ 
- Необходимость условия почти очевидна. 
- Пусть $S \subset V (G)$, а $M$ — совершенное паросочетание. 
- Тогда одна из вершин каждой нечетной компоненты связности графа $G − S$ должна быть соединена с вершиной из $S$ ребром паросочетания $M$ и все эти вершины — разные!
> *Объяснение*: должна быть соединена с вершиной из $S$ (*в нечетной компоненте связности нечётное число вершин* $\Rightarrow$ *останется ровно одна вершина, непокрытая паросочетанием*), 
> *Объяснение*: все эти вершины разные (*так как паросочетание совершенное*)
- А значит должно выполняться $o(G − S) \leq |S|$

$\Leftarrow$ 
- Предположим, что граф удовлетворяет условию, но не имеет совершенного паросочетания. Тогда, в частности, $o(G-\varnothing) \leq |\varnothing| = 0$, то есть, $v(G)$ чётно.
- Пусть $G^∗$ — максимальный надграф $G$ на том же множестве вершин, не имеющий совершенного паросочетания. Мы построим совершенное паросочетание в $G^∗$ и придем к противоречию.
- Для любого $S \subset V (G)$ очевидно, выполняется
неравенство $o(G^∗ − S) \leq o(G − S) \leq |S|$.
- Пусть $U = \{u \in V(G) : d_{G^∗}(u) = v (G) − 1\}$. Очевидно,
$G^∗$ — не полный граф, поэтому $U \neq V(G)$.
> *Объяснение*: из-за $d_{G^∗}(u) = v (G) − 1$ мы получили, что вершины $U$ смежны всем вершинам подграфа $G$

*Докажем, что граф* $G^∗ − \ U$ *— объединение нескольких несвязанных друг с другом полных графов*
##### Поддоказательство
- Предположим, что это не так. Тогда существуют такие вершины $x$, $y$ , $z \in V(G) \ \backslash \ U$, что $xy$, $yz \in E(G^∗)$, но $xz \not\in E(G^∗)$.
- Так как $y \not\in U$, то существует такая вершина $w \not\in U$, что $yw \not\in E(G^∗)$.
- Ввиду максимальности графа $G^∗$ существует совершенное паросочетание $M_1$ в графе $G^∗ + xz$ и совершенное паросочетание $M_2$ в графе $G^∗ + yw$. Так как в графе $G^∗$ нет совершенного паросочетания, $xz \in M_1$ и $yw \in M_2$.
- Пусть $H = (V(G), M_1 \Delta M_2)$. Очевидно, граф $H$ — несвязное объединение чётных циклов, в каждом из которых чередуются рёбра паросочетаний $M_1$ и $M_2$.
> *Объяснение*: $M_1 \Delta M_2$ - симметрическая разность

- Рёбра $xz$ и $yw$ принадлежат ровно одному из паросочетаний $M_1$ и $M_2$, и потому лежат в $E(H)$.
- На вершинах любой компоненты связности графа $H$ существует совершенное паросочетание с рёбрами из $M_1$ и совершенное паросочетание с рёбрами из $M_2$.

*Рассмотрим два случая*.
**Случай 1. Рёбра** $xz$ **и** $yw$ **лежат в разных компонентах** $C_1$ **и** $C_2$ **графа** $H$
- Тогда на вершинах $C_1$ мы выберем рёбра паросочетания $M_2$, на вершинах $C_2$ мы выберем рёбра паросочетания $M_1$, а в остальных компонентах графа $H$ — любое из этих паросочетаний.
- В итоге получится совершенное паросочетание графа $G^∗$, противоречие.

**Случай 2. Рёбра** $xz$ **и** $yw$ **лежат в одной компоненте** $C$ **графа** $H$.
![Tutte](https://github.com/Dkanil/ITMO/blob/main/semester1/DM/Tutte.png?raw=true)
- В силу симметричности $x$ и $z$ можно считать, что вершины расположены в чётном цикле $C$ в порядке $ywzx$ (см. рисунок).
- Рассмотрим простой путь $P = xCyzCw$ , состоящий из двух дуг цикла $C$ и ребра $yz$. Тогда $V(P) = V (C)$ и $E(P) \subset E(G^∗)$. Следовательно, существует совершенное паросочетание $M_C \subset E (G^∗)$ на вершинах компоненты связности $W$.
- В остальных компонентах графа $H$ выберем рёбра любого из паросочетаний $M_1$ и $M_2$. В итоге получится совершенное паросочетание графа $G^∗$, противоречие.

*Вернёмся к [основному доказательству](#поддоказательство)*
- Граф $G^∗ − \ U$ есть объединение нескольких несвязанных полных графов. В силу условия, среди них не более чем $|U|$ имеет нечетное число вершин.
- В каждой чётной компоненте графа $G^∗ − \ U$ мы построим полное паросочетание, в каждой нечётной компоненте — паросочетание, покрывающее все вершины, кроме одной, а оставшуюся вершину соединим с вершиной из $U$ (при этом мы используем различные вершины множества $U$: их хватит ввиду $o(G^∗ − \ U) \leq |U|)$.
- Наконец, мы разобём на пары оставшиеся непокрытыми вершины множества $U$: это можно сделать, так как каждая из этих вершин смежна в графе $G^∗$ со всеми остальными. Таким образом, мы получили совершенное паросочетание в графе $G^∗$, противоречие.

## Билет 9. Теорема Петерсена о совершенном паросочетании в регулярном графе степени 3.
1) **Кубический граф** - граф, все вершины которого имеют степень 3.
2) **Мост графа** — ребро, не входящее ни в один цикл

### Теорема Петерсена
**(J. Petersen, 1891.)** Пусть $G$ — связный кубический граф, в котором не более двух мостов. Тогда в графе $G$ есть совершенное паросочетание.
#### Доказательство
- Предположим, что совершенного паросочетания в $G$ нет. Тогда по [Теореме Татта](#теорема-татта) существует такое множество $S \subset V(G)$, что $o(G − S) > |S|$.
- Так как в кубическом графе четное число вершин, то $S \neq \varnothing$ и $o(G − S) \equiv |S| \pmod{2}$.
>  *Объяснение*:  в кубическом графе четное число вершин по лемме о рукопожатиях

- Пусть $U_1, \dots , U_n$ — все нечётные компоненты связности графа $G − S$. Тогда $n \geq |S| + 2$.
- Пусть $m_i = e_G (U_i , S)$. Тогда 
$m_i = (\sum_{v \in U_i} d_G (v )) − 2e(G (U_i)) = 3|U_i| − 2e(G(U_i))$ — очевидно, нечетно.
> *Объяснение:* Число рёбер, соединяющих $U_i$​ с $S$ равно общему числу рёбер, инцидентных вершинам $U_i$, без внутренних рёбер.
> *Объяснение:* $\sum_{v \in U_i} = 3|U_i|$, так как граф кубический 

- Так как не более чем два ребра графа $G$ — мосты, то не более, чем два числа из $m_1, \dots , m_n$ равны $1$, а все остальные — не менее, чем $3$.
- Тогда $3|S| = \sum_{v \in S} d_G (v) \geq \sum_{i=1}^n m_i \geq 3(n − 2) + 2 = 3n − 4 \geq 3(|S| + 2) − 4 > 3|S|$, противоречие. 

Результат теоремы Петерсона в некотором смысле наилучший возможный. 
Пример связного кубического графа с тремя мостами, у которого нет совершенного паросочетания:
![Petersen](https://github.com/Dkanil/ITMO/blob/main/semester1/DM/Petersen.png?raw=true)
## Билет 10. Теорема Петерсена о выделении 2-фактора в 2k-регулярном графе и ее следствия о регулярных факторах.


## Билет 11. Теорема Томассена о почти регулярном факторе почти регулярного графа.

## Билет 12. Дефицит графа. Формула Бержа.


# Глава 3.2. Элементарная комбинаторика

## Билет 1. Число сочетаний из n элементов по k. Формула для числа сочетаний.

## Билет 2. Число сочетаний с повторениями из n элементов по k. Формула для числа сочетаний с повторениями.

## Билет 3. Простейшие свойства биномиальных коэффициентов. Алгебраические и комбинаторные доказательства. Треугольник Паскаля.

## Билет 4. Бином Ньютона. Сумма и знакопеременная сумма биномиальных коэффициентов (алгебраические и комбинаторные доказательства).

## Билет 5. Мультиномиальные коэффициенты. Определение и формула. Обобщенный бином Ньютона.

## Билет 6. Формула включений-исключений. Переформулировка этой формулы в терминах свойств.

## Билет 7. Субфакториалы. Определение и рекуррентное соотношение для субфакториалов. Связь с обычными факториалами.

## Билет 8. Явная формула для субфакториала. Следствие о ближайшем целом числе к $\frac{n!}{e}$.

## Билет 9. Функция Эйлера. Определение и формула (доказательство с помощью формулы включений-исключений).

## Билет 10. Формула для числа сюръекций.

